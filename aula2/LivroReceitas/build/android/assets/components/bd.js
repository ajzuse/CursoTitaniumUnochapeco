function abrirBaseDados(){return Ti.Database.open("BaseReceitas")}function tabelaExiste(e){var a="SELECT * FROM "+e,i=!0,t=abrirBaseDados();try{t.execute(a)}catch(r){i=!1}return t.close(),i}function executarBD(e){var a=abrirBaseDados();a.execute(e),a.close()}function validarBaseDados(){tabelaExiste("Categoria")||criarTabelas()}function criarTabela(e,a){var t="CREATE TABLE "+e+" (";for(i in a)t+=a[i].nome+" "+a[i].tipo,i!=a.length-1&&(t+=",");t+=");",executarBD(t)}function criarTabelas(){var e=[{nome:"id",tipo:"INTEGER PRIMARY KEY"},{nome:"nome",tipo:"TEXT"}],a=[{nome:"id",tipo:"INTEGER PRIMARY KEY"},{nome:"idCategoria",tipo:"INTEGER"},{nome:"nome",tipo:"TEXT"},{nome:"tempoPreparo",tipo:"INTEGER"},{nome:"rendimento",tipo:"INTEGER"},{nome:"nota",tipo:"INTEGER"},{nome:"imagem",tipo:"TEXT"}],i=[{nome:"id",tipo:"INTEGER PRIMARY KEY"},{nome:"idReceita",tipo:"INTEGER"},{nome:"nome",tipo:"TEXT"},{nome:"quantidade",tipo:"REAL"},{nome:"unidade",tipo:"TEXT"},{nome:"aplicacao",tipo:"TEXT"}];criarTabela("Categoria",e),criarTabela("Receita",a),criarTabela("Ingrediente",i)}function verificarCategoriaExiste(e){if("undefined"==typeof e)return!1;var a="SELECT id FROM Categoria WHERE nome = '"+e+"'",i=abrirBaseDados(),t=i.execute(a).isValidRow();return i.close(),t}function inserirCategoria(e){var a=buscarIdCategoria(e);if(!verificarCategoriaExiste(e)){var i="INSERT INTO Categoria VALUES("+a+",'"+e+"');";executarBD(i)}return a}function buscarIdCategoria(e){var a,i=abrirBaseDados();if(verificarCategoriaExiste(e)){var t="SELECT id FROM Categoria WHERE nome = '"+e+"'",r=i.execute(t);a=r.fieldByName("id")}else{var t="SELECT MAX(id) FROM Categoria",r=i.execute(t);a=r.isValidRow()?parseInt(r.fieldByName("id"))+1:0}i.close()}function buscarNovoId(e){var a=abrirBaseDados(),i="SELECT MAX(id) FROM "+e,t=a.execute(i);return id=t.isValidRow()?parseInt(t.fieldByName("id"))+1:0,a.close(),id}